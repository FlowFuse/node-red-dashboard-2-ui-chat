{"version":3,"file":"ui-chat.umd.js","sources":["../ui/components/icons/Airplane.vue","../ui/components/UIChat.vue"],"sourcesContent":["<template>\n  <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\">\n    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5\" />\n  </svg>\n</template>","<template>\n    <div class=\"nrdb-ui-chat\">\n        <!-- Chat messages container -->\n        <div class=\"nrdb-ui-chat-messages\">\n            <div v-for=\"(message, index) in messages\" \n                 :key=\"index\" \n                 class=\"nrdb-ui-message\"\n                 :class=\"message.sent ? 'sent' : 'received'\">\n                <div class=\"nrdb-ui-message-author\" v-if=\"props.showAuthor && !message.sent\">\n                    {{ message.author }}\n                </div>\n                <div class=\"nrdb-ui-message-content\">\n                    {{ message.text }}\n                </div>\n                <div class=\"nrdb-ui-message-time\">\n                    {{ message.time }}\n                </div>\n            </div>\n            <div v-if=\"typing\" class=\"nrdb-ui-message received\">\n                <div class=\"nrdb-ui-message-content nrdb-ui-message-typing\">\n                    <div class=\"nrdb-ui-message-typing-dot\"></div>\n                    <div class=\"nrdb-ui-message-typing-dot\"></div>\n                    <div class=\"nrdb-ui-message-typing-dot\"></div>\n                </div>\n            </div>\n        </div>\n        \n        <!-- Message input form -->\n        <div class=\"nrdb-ui-chat-input\">\n            <div class=\"nrdb-ui-chat-input-container\">\n                <input type=\"text\" \n                       v-model=\"newMessage\" \n                       @keyup.enter=\"sendMessage\"\n                       placeholder=\"Type a message...\"\n                       :disabled=\"!state.enabled\">\n                <button @click=\"sendMessage\" class=\"nrdb-ui-chat-send\"\n                        :disabled=\"!state.enabled || !newMessage.trim()\">\n                    <Airplane />\n                </button>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n\nimport Airplane from './icons/Airplane.vue'\n\nexport default {\n    name: 'UIChat',\n    inject: ['$socket', '$dataTracker'],\n    components: {\n        Airplane\n    },\n    props: {\n        /* do not remove entries from this - Dashboard's Layout Manager's will pass this data to your component */\n        id: { type: String, required: true },\n        props: { type: Object, default: () => ({}) },\n        state: { type: Object, default: () => ({ enabled: false, visible: false }) }\n    },\n    setup (props) {\n        \n    },\n    data () {\n        return {\n            messages: [],\n            newMessage: '',\n            typing: false\n        }\n    },\n    computed: {\n        \n    },\n    created () {\n        // setup our event handlers, and informs Node-RED that this widget has loaded\n        this.$dataTracker(this.id, this.onInput, this.onLoad)\n    },\n    methods: {\n        onInput (msg) {\n            if (msg.topic === '_typing') {\n                this.typing = true\n            } \n            // Handle incoming messages from Node-RED\n            else if (msg?.payload) {\n                this.typing = false\n                this.messages.push({\n                    author: msg.topic,\n                    text: msg.payload,\n                    time: new Date().toLocaleTimeString(),\n                    sent: false\n                })\n            }\n            this.$nextTick(() => {\n                this.scrollToBottom()\n            })\n        },        \n        onLoad (msg) {\n            // Handle initial load\n            if (Array.isArray(msg?.payload)) {\n                this.messages = msg.payload.map(m => ({\n                    ...m,\n                    time: new Date(m.timestamp || Date.now()).toLocaleTimeString()\n                }))\n                this.$nextTick(() => {\n                    this.scrollToBottom()\n                })\n            }\n        },\n        send (msg) {\n            this.$socket.emit('widget-action', this.id, msg)\n        },  \n        sendMessage () {\n            if (!this.newMessage.trim() || !this.state.enabled) return\n            \n            // Create message object\n            const message = {\n                author: 'user',\n                text: this.newMessage,\n                time: new Date().toLocaleTimeString(),\n                sent: true\n            }\n            \n            // Add to local messages\n            this.messages.push(message)\n            \n            // Send to Node-RED\n            this.send({\n                topic: 'user-message',\n                payload: this.newMessage\n            })\n            \n            // Clear input\n            this.newMessage = ''\n            \n            // Scroll to bottom\n            this.$nextTick(() => {\n                this.scrollToBottom()\n            })\n        },        \n        scrollToBottom () {\n            const container = this.$el.querySelector('.nrdb-ui-chat-messages')\n            if (container) {\n                container.scrollTop = container.scrollHeight\n            }\n        }\n    }\n}\n</script>\n\n<style scoped>\n/* CSS is auto scoped, but using named classes is still recommended */\n@import \"../stylesheets/ui-chat.css\";\n</style>\n"],"names":["_hoisted_1","_sfc_render","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","_sfc_main","props","msg","m","message","container","_hoisted_2","_hoisted_4","_hoisted_5","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_createCommentVNode","_Fragment","_renderList","$data","index","_normalizeClass","$props","_hoisted_3","_toDisplayString","_hoisted_6","$event","_withKeys","$options","args","_createVNode","_component_Airplane"],"mappings":"+UACOA,EAAkC,CAAC,MAAW,6BAAC,KAAA,OAAoB,QAAA,YAAmB,eAAqB,6BAAhH,SAAAC,EAAAC,EAAAC,EAAA,QAC+JC,EAAA,UAAA,EAAAC,EAAA,mBAAA,MAAAL,EAAAG,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAvJG,EAAAA,mBAAe,OAAO,CAAC,yBAAwB,kBAAqG,2HC8C9J,MAAKC,EAAU,CACX,KAAM,SACN,OAAQ,CAAC,UAAW,cAAc,EAClC,WAAY,CACR,8JACH,EACD,MAAO,CAEH,GAAI,CAAE,KAAM,OAAQ,SAAU,EAAM,EACpC,MAAO,CAAE,KAAM,OAAQ,QAAS,KAAO,CAAE,EAAG,EAC5C,MAAO,CAAE,KAAM,OAAQ,QAAS,KAAO,CAAE,QAAS,GAAO,QAAS,IAAS,CAC9E,EACD,MAAOC,EAAO,CAEb,EACD,MAAQ,CACJ,MAAO,CACH,SAAU,CAAE,EACZ,WAAY,GACZ,OAAQ,EACZ,CACH,EACD,SAAU,CAET,EACD,SAAW,CAEP,KAAK,aAAa,KAAK,GAAI,KAAK,QAAS,KAAK,MAAM,CACvD,EACD,QAAS,CACL,QAASC,EAAK,CACNA,EAAI,QAAU,UACd,KAAK,OAAS,GAGTA,GAAA,MAAAA,EAAK,UACV,KAAK,OAAS,GACd,KAAK,SAAS,KAAK,CACf,OAAQA,EAAI,MACZ,KAAMA,EAAI,QACV,KAAM,IAAI,KAAM,EAAC,mBAAoB,EACrC,KAAM,EACT,CAAA,GAEL,KAAK,UAAU,IAAM,CACjB,KAAK,eAAc,CACtB,CAAA,CACJ,EACD,OAAQA,EAAK,CAEL,MAAM,QAAQA,GAAA,YAAAA,EAAK,OAAO,IAC1B,KAAK,SAAWA,EAAI,QAAQ,IAAIC,IAAM,CAClC,GAAGA,EACH,KAAM,IAAI,KAAKA,EAAE,WAAa,KAAK,IAAK,CAAA,EAAE,mBAAkB,CAChE,EAAE,EACF,KAAK,UAAU,IAAM,CACjB,KAAK,eAAc,CACtB,CAAA,EAER,EACD,KAAMD,EAAK,CACP,KAAK,QAAQ,KAAK,gBAAiB,KAAK,GAAIA,CAAG,CAClD,EACD,aAAe,CACX,GAAI,CAAC,KAAK,WAAW,KAAK,GAAK,CAAC,KAAK,MAAM,QAAS,OAGpD,MAAME,EAAU,CACZ,OAAQ,OACR,KAAM,KAAK,WACX,KAAM,IAAI,KAAM,EAAC,mBAAoB,EACrC,KAAM,EACV,EAGA,KAAK,SAAS,KAAKA,CAAO,EAG1B,KAAK,KAAK,CACN,MAAO,eACP,QAAS,KAAK,UACjB,CAAA,EAGD,KAAK,WAAa,GAGlB,KAAK,UAAU,IAAM,CACjB,KAAK,eAAc,CACtB,CAAA,CACJ,EACD,gBAAkB,CACd,MAAMC,EAAY,KAAK,IAAI,cAAc,wBAAwB,EAC7DA,IACAA,EAAU,UAAYA,EAAU,aAExC,CACJ,CACJ,EAjJSZ,EAAA,CAAA,MAAM,cAAc,EAEhBa,EAAA,CAAA,MAAM,uBAAuB,KAH1C,IAAA,EAQqB,MAAM,0BAGNC,EAAA,CAAA,MAAM,yBAAyB,EAG/BC,EAAA,CAAA,MAAM,sBAAsB,KAdjD,IAAA,EAkB+B,MAAM,4BAUxBC,EAAA,CAAA,MAAM,oBAAoB,EACtBC,EAAA,CAAA,MAAM,8BAA8B,EA7BrDC,EAAA,CAAA,UAAA,EAAAC,EAAA,CAAA,UAAA,iEACI,OAAAf,YAAA,EAAAC,qBAwCM,MAxCNL,EAwCM,CAvCFoB,EAAAA,mBAAgC,2BAAA,EAChCd,EAAA,mBAsBM,MAtBNO,EAsBM,EArBFT,EAAAA,UAAA,EAAA,EAAAC,EAAA,mBAaMgB,gBAjBlBC,EAI4C,WAAAC,EAAA,SAJ5C,CAIyBZ,EAASa,mBAAtBnB,EAaM,mBAAA,MAAA,CAZA,IAAKmB,EACN,MANjBC,EAMuB,eAAA,CAAA,kBACEd,EAAQ,KAAI,OAAA,UAAA,CAAA,IACqBe,EAAA,MAAM,YAAe,CAAAf,EAAQ,MAAvEP,YAAA,EAAAC,EAAA,mBAEM,MAFNsB,EACOC,EAAAA,gBAAAjB,EAAQ,MAAM,EAAA,CAAA,GATrCS,EAAA,mBAAA,OAAA,EAAA,EAWgBd,EAAA,mBAEM,MAFNQ,EACOc,EAAAA,gBAAAjB,EAAQ,IAAI,EAAA,CAAA,EAEnBL,EAAA,mBAEM,MAFNS,EACOa,EAAA,gBAAAjB,EAAQ,IAAI,EAAA,CAAA,cAGZY,EAAM,QAAjBnB,YAAA,EAAAC,qBAMM,MANNwB,EAMM1B,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CALFG,EAAAA,mBAIM,MAAA,CAJD,MAAM,gDAAgD,EAAA,CACvDA,EAAAA,mBAA8C,MAAA,CAAzC,MAAM,4BAA4B,CAAA,EACvCA,EAAAA,mBAA8C,MAAA,CAAzC,MAAM,4BAA4B,CAAA,EACvCA,EAAAA,mBAA8C,MAAA,CAAzC,MAAM,4BAA4B,CAAA,WAtB3Dc,EAAA,mBAAA,OAAA,EAAA,IA2BQA,EAAAA,mBAA2B,sBAAA,EAC3Bd,EAAA,mBAYM,MAZNU,EAYM,CAXFV,EAAA,mBAUM,MAVNW,EAUM,kBATFX,EAIkC,mBAAA,QAAA,CAJ3B,KAAK,OA9B5B,sBAAAH,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA2B,GA+BgCP,EAAU,WAAAO,GAClB,QAAK3B,EAAA,CAAA,IAAAA,EAAA,CAAA,EAhC7B4B,mBAgCqCC,EAAW,aAAAA,EAAA,YAAA,GAAAC,CAAA,EAAA,CAAA,OAAA,CAAA,GACzB,YAAY,oBACX,SAAQ,CAAGP,EAAK,MAAC,OAlCzC,EAAA,KAAA,GAAAR,CAAA,EAAA,eA+BgCK,EAAU,UAAA,IAI1BjB,EAAAA,mBAGS,SAAA,CAHA,4BAAO0B,EAAW,aAAAA,EAAA,YAAA,GAAAC,CAAA,GAAE,MAAM,oBAC1B,UAAWP,EAAK,MAAC,SAAY,CAAAH,EAAA,WAAW,KAAI,IACjDW,EAAAA,YAAYC,CAAA,CArChC,EAAA,EAAAhB,CAAA"}